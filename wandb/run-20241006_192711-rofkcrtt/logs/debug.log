2024-10-06 19:27:11,275 INFO    MainThread:925998 [wandb_setup.py:_flush():79] Current SDK version is 0.18.3
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_setup.py:_flush():79] Configure stats pid to 925998
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_setup.py:_flush():79] Loading settings from /data2/Users/aghyad/.config/wandb/settings
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_setup.py:_flush():79] Loading settings from /data2/Users/aghyad/publish_code_unlearn_eval/wandb/settings
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_setup.py:_flush():79] Loading settings from environment variables: {}
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_setup.py:_flush():79] Applying setup settings: {'mode': None, '_disable_service': None}
2024-10-06 19:27:11,276 WARNING MainThread:925998 [wandb_setup.py:_flush():79] Could not save program above cwd: /data2/Users/aghyad/venv/lib/python3.10/site-packages/ray/_private/workers/default_worker.py
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_setup.py:_flush():79] Inferring run settings from compute environment: {'program_relpath': None, 'program_abspath': '/data2/Users/aghyad/venv/lib/python3.10/site-packages/ray/_private/workers/default_worker.py', 'program': '/data2/Users/aghyad/venv/lib/python3.10/site-packages/ray/_private/workers/default_worker.py'}
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_setup.py:_flush():79] Applying login settings: {}
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_init.py:_log_setup():532] Logging user logs to /data2/Users/aghyad/publish_code_unlearn_eval/wandb/run-20241006_192711-rofkcrtt/logs/debug.log
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_init.py:_log_setup():533] Logging internal logs to /data2/Users/aghyad/publish_code_unlearn_eval/wandb/run-20241006_192711-rofkcrtt/logs/debug-internal.log
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_init.py:init():617] calling init triggers
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_init.py:init():624] wandb.init called with sweep_config: {}
config: {'train_files': ['wmdp-deduped/mcq_split_0', 'wmdp-deduped/mcq_split_1', 'wmdp-deduped/mcq_split_2', 'wmdp-deduped/mcq_split_3', 'wmdp-deduped/mcq_split_4'], 'wrong_unlearn_files': ['wmdp-deduped/whp_corpus_split_0', 'wmdp-deduped/whp_corpus_split_1', 'wmdp-deduped/whp_corpus_split_2', 'wmdp-deduped/whp_corpus_split_3', 'wmdp-deduped/whp_corpus_split_4'], 'fixed_wrong_unlearn_files': ['wmdp-deduped/fwf_corpus_split_0', 'wmdp-deduped/fwf_corpus_split_1', 'wmdp-deduped/fwf_corpus_split_2', 'wmdp-deduped/fwf_corpus_split_3', 'wmdp-deduped/fwf_corpus_split_4'], 'val_files': ['wmdp-deduped/split_0', 'wmdp-deduped/split_1', 'wmdp-deduped/split_2', 'wmdp-deduped/split_3', 'wmdp-deduped/split_4'], 'dev_set': 'wmdp-deduped/dev', 'base_model': 'HuggingFaceH4/zephyr-7b-beta', 'lr': 1.6e-06, 'name': 'models/GD/WMDP_MCQ_FINEWEB/thrd_CUT_GD_WMDP_mcq_fineweb_with_ft/sc=20HuggingFaceH4/zephyr-7b-beta-rc0.2-lr1.6e-06-epochs4', 'epochs': 4, 'warmup_steps': 24, 'retain_files': ['fineweb_edu_seed-42/split_0', 'fineweb_edu_seed-42/split_1', 'fineweb_edu_seed-42/split_2', 'fineweb_edu_seed-42/split_3', 'fineweb_edu_seed-42/split_4'], 'val_retain_files': ['mmlu_cats_random_trimmed/mmlu_health', 'mmlu_cats_random_trimmed/mmlu_history', 'mmlu_cats_random_trimmed/mmlu_law', 'mmlu_cats_random_trimmed/mmlu_philosophy', 'mmlu_cats_random_trimmed/mmlu_social sciences'], 'retain_dev_file': 'mmlu_cats_random_trimmed/dev', 'max_samples': 999999999, 'data_seed': 4, 'eval_every': 1, 'keep_set': None, 'keep_set_weight': None, 'train_on_wrong_answer': False, 'train_set_size': None, 'val_set_size': None, 'kind': 'base', 'save_name': 'models/GD/WMDP_MCQ_FINEWEB/thrd_CUT_GD_WMDP_mcq_fineweb_with_ft/sc=20HuggingFaceH4/zephyr-7b-beta-rc0.2-lr1.6e-06-epochs4', 'version': 'v2.11', 'retain_coeff': 0.2, 'project_name': 'thrd_CUT_GD_WMDP_mcq_fineweb_with_ft', 'unlearn_type': <UnlearnType.GD: 2>, 'results_file': None, 'just_eval': False, 'freeze_layers': None, 'mcq': False, 'hydra_dict': {'just_eval': False, 'eval_model_paths': [''], 'only_ft': False, 'ft_model_paths': [['meta-llama/Meta-Llama-3-8B', 'WMDP']], 'dont_ft': False, 'testing': False, 'raise_exceptions': False, 'num_gpus': 8, 'model_id': 'HuggingFaceH4/zephyr-7b-beta', 'num_layers': 32, 'datasets': ['WMDP_MCQ_FINEWEB'], 'wandb_project_name': 'thrd_CUT_GD_WMDP_mcq_fineweb_with_ft', 'results_dir': 'evals/pipeline', 'batch_size': 4, 'val_batch_size': 8, 'warmup_steps': 24, 'data_seed': 4, 'eval_every': 1, 'unlearn.types': ['GD'], 'unlearn.many_cut_sc': True, 'unlearn.cut_scs': [0.1, 1, 10], 'unlearn.save_unlearn_model': True, 'unlearn.freeze_layers_coeffs': None, 'unlearn.freeze_layers': None, 'unlearn.types_config.CUT.loss_type': 'CORPUS', 'unlearn.types_config.CUT.datasets_config.YEARS.epochs_lst': [5], 'unlearn.types_config.CUT.datasets_config.YEARS.lrs': [4e-07], 'unlearn.types_config.CUT.datasets_config.YEARS.rcs.range': [100.0, 1000.0, 10000.0], 'unlearn.types_config.CUT.datasets_config.YEARS.rcs.add': [0, 1200], 'unlearn.types_config.CUT.datasets_config.YEARS_MMLU_RETAIN.epochs_lst': [5], 'unlearn.types_config.CUT.datasets_config.YEARS_MMLU_RETAIN.lrs': [4e-07], 'unlearn.types_config.CUT.datasets_config.YEARS_MMLU_RETAIN.rcs.range': [100.0, 1000.0, 10000.0], 'unlearn.types_config.CUT.datasets_config.YEARS_MMLU_RETAIN.rcs.add': [0, 1200], 'unlearn.types_config.CUT.datasets_config.MMLU.epochs_lst': [5], 'unlearn.types_config.CUT.datasets_config.MMLU.lrs': [4e-07], 'unlearn.types_config.CUT.datasets_config.MMLU.rcs.range': [100.0, 1000.0, 10000.0], 'unlearn.types_config.CUT.datasets_config.MMLU.rcs.add': [0, 1200], 'unlearn.types_config.CUT.datasets_config.WMDP_CORPUS.epochs_lst': [5], 'unlearn.types_config.CUT.datasets_config.WMDP_CORPUS.lrs': [4e-07], 'unlearn.types_config.CUT.datasets_config.WMDP_CORPUS.rcs.range': [0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0], 'unlearn.types_config.CUT.datasets_config.WMDP_CORPUS.rcs.add': [0], 'unlearn.types_config.CUT.datasets_config.WMDP_CORPUS_FINEWEB.epochs_lst': [5], 'unlearn.types_config.CUT.datasets_config.WMDP_CORPUS_FINEWEB.lrs': [4e-07], 'unlearn.types_config.CUT.datasets_config.WMDP_CORPUS_FINEWEB.rcs.range': [0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0], 'unlearn.types_config.CUT.datasets_config.WMDP_CORPUS_FINEWEB.rcs.add': [], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_CORPUS.epochs_lst': [5], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_CORPUS.lrs': [4e-07], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_CORPUS.rcs.range': [100.0, 200.0, 400.0, 800.0, 1600.0, 3200.0, 6400.0], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_CORPUS.rcs.add': [], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.epochs_lst': [1, 2], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.lrs': [2e-05, 4e-05, 8e-05], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.rcs.range': [100.0, 200.0, 400.0, 800.0, 1600.0, 3200.0, 6400.0], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.rcs.add': [], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_FINEWEB.epochs_lst': [1], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_FINEWEB.lrs': [4e-05], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_FINEWEB.rcs.range': [100.0, 200.0, 400.0, 800.0, 1600.0, 3200.0, 6400.0], 'unlearn.types_config.CUT.datasets_config.WMDP_MCQ_FINEWEB.rcs.add': [], 'unlearn.types_config.CUT.datasets_config.RANDOM_BD.epochs_lst': [5], 'unlearn.types_config.CUT.datasets_config.RANDOM_BD.lrs': [4e-07], 'unlearn.types_config.CUT.datasets_config.RANDOM_BD.rcs.range': [0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0], 'unlearn.types_config.CUT.datasets_config.RANDOM_BD.rcs.add': [0, 1200], 'unlearn.types_config.GD.loss_type': 'CORPUS', 'unlearn.types_config.GD.datasets_config.YEARS.epochs_lst': [5], 'unlearn.types_config.GD.datasets_config.YEARS.lrs': [4e-07], 'unlearn.types_config.GD.datasets_config.YEARS.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.GD.datasets_config.YEARS.rcs.add': [0, 0.002], 'unlearn.types_config.GD.datasets_config.YEARS_MMLU_RETAIN.epochs_lst': [5], 'unlearn.types_config.GD.datasets_config.YEARS_MMLU_RETAIN.lrs': [4e-07], 'unlearn.types_config.GD.datasets_config.YEARS_MMLU_RETAIN.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.GD.datasets_config.YEARS_MMLU_RETAIN.rcs.add': [0, 0.002], 'unlearn.types_config.GD.datasets_config.MMLU.epochs_lst': [5], 'unlearn.types_config.GD.datasets_config.MMLU.lrs': [4e-07], 'unlearn.types_config.GD.datasets_config.MMLU.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.GD.datasets_config.MMLU.rcs.add': [0, 2, 4], 'unlearn.types_config.GD.datasets_config.WMDP.epochs_lst': [5], 'unlearn.types_config.GD.datasets_config.WMDP.lrs': [4e-07], 'unlearn.types_config.GD.datasets_config.WMDP.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.GD.datasets_config.WMDP.rcs.add': [0, 2, 4], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS.epochs_lst': [2], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS.lrs': [4e-07, 8e-07, 1.6e-06, 3.2e-06], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS.rcs.range': [0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS.rcs.add': [0], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS_FINEWEB.epochs_lst': [2], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS_FINEWEB.lrs': [3.2e-06], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS_FINEWEB.rcs.range': [0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS_FINEWEB.rcs.add': [], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS_MMLU.epochs_lst': [8], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS_MMLU.lrs': [1.6e-06, 3.2e-06], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS_MMLU.rcs.range': [0.01, 0.1, 1.0, 10.0, 100.0, 1000.0, 10000.0], 'unlearn.types_config.GD.datasets_config.WMDP_CORPUS_MMLU.rcs.add': [0], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_CORPUS.epochs_lst': [2, 4, 8], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_CORPUS.lrs': [5e-08, 1e-07, 2e-07, 4e-07, 8e-07, 1.6e-06, 3.2e-06], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_CORPUS.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_CORPUS.rcs.add': [0, 2, 4], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.epochs_lst': [2], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.lrs': [1.6e-06], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.rcs.add': [2, 8], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_FINEWEB.epochs_lst': [4], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_FINEWEB.lrs': [1.6e-06], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_FINEWEB.rcs.range': [0.1, 0.2, 0.4, 0.8, 1.6, 3.2, 6.4, 12.8, 25.6, 51.2, 102.4, 204.8, 409.6, 819.2, 1638.4, 3276.8, 6553.6], 'unlearn.types_config.GD.datasets_config.WMDP_MCQ_FINEWEB.rcs.add': [0], 'unlearn.types_config.GD.datasets_config.RANDOM_BD.epochs_lst': [5], 'unlearn.types_config.GD.datasets_config.RANDOM_BD.lrs': [4e-07], 'unlearn.types_config.GD.datasets_config.RANDOM_BD.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.GD.datasets_config.RANDOM_BD.rcs.add': [0, 2, 4], 'unlearn.types_config.WHP.loss_type': 'CORPUS', 'unlearn.types_config.WHP.datasets_config.YEARS.epochs_lst': [5], 'unlearn.types_config.WHP.datasets_config.YEARS.lrs': [8e-07], 'unlearn.types_config.WHP.datasets_config.YEARS.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.WHP.datasets_config.YEARS.rcs.add': [0, 2, 4], 'unlearn.types_config.WHP.datasets_config.YEARS_MMLU_RETAIN.epochs_lst': [5], 'unlearn.types_config.WHP.datasets_config.YEARS_MMLU_RETAIN.lrs': [8e-07], 'unlearn.types_config.WHP.datasets_config.YEARS_MMLU_RETAIN.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.WHP.datasets_config.YEARS_MMLU_RETAIN.rcs.add': [0, 2, 4], 'unlearn.types_config.WHP.datasets_config.MMLU.epochs_lst': [5], 'unlearn.types_config.WHP.datasets_config.MMLU.lrs': [4e-07, 8e-07], 'unlearn.types_config.WHP.datasets_config.MMLU.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.WHP.datasets_config.MMLU.rcs.add': [0, 2, 4], 'unlearn.types_config.WHP.datasets_config.WMDP_MCQ_CORPUS.epochs_lst': [5], 'unlearn.types_config.WHP.datasets_config.WMDP_MCQ_CORPUS.lrs': [4e-07, 8e-07, 1.6e-06], 'unlearn.types_config.WHP.datasets_config.WMDP_MCQ_CORPUS.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.WHP.datasets_config.WMDP_MCQ_CORPUS.rcs.add': [0, 2, 4], 'unlearn.types_config.WHP.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.epochs_lst': [5], 'unlearn.types_config.WHP.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.lrs': [3.2e-06], 'unlearn.types_config.WHP.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.WHP.datasets_config.WMDP_MCQ_CORPUS_FINEWEB.rcs.add': [0, 2, 4], 'unlearn.types_config.WHP.datasets_config.RANDOM_BD.epochs_lst': [5], 'unlearn.types_config.WHP.datasets_config.RANDOM_BD.lrs': [4e-07, 8e-07], 'unlearn.types_config.WHP.datasets_config.RANDOM_BD.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.WHP.datasets_config.RANDOM_BD.rcs.add': [0, 2, 4], 'unlearn.types_config.FWF.loss_type': 'CORPUS', 'unlearn.types_config.FWF.datasets_config.YEARS.epochs_lst': [5], 'unlearn.types_config.FWF.datasets_config.YEARS.lrs': [8e-07], 'unlearn.types_config.FWF.datasets_config.YEARS.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.FWF.datasets_config.YEARS.rcs.add': [0, 2, 4], 'unlearn.types_config.FWF.datasets_config.YEARS_MMLU_RETAIN.epochs_lst': [5], 'unlearn.types_config.FWF.datasets_config.YEARS_MMLU_RETAIN.lrs': [8e-07], 'unlearn.types_config.FWF.datasets_config.YEARS_MMLU_RETAIN.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.FWF.datasets_config.YEARS_MMLU_RETAIN.rcs.add': [0, 2, 4], 'unlearn.types_config.FWF.datasets_config.MMLU.epochs_lst': [5], 'unlearn.types_config.FWF.datasets_config.MMLU.lrs': [4e-07, 8e-07], 'unlearn.types_config.FWF.datasets_config.MMLU.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.FWF.datasets_config.MMLU.rcs.add': [0, 2, 4], 'unlearn.types_config.FWF.datasets_config.WMDP_MCQ_CORPUS.epochs_lst': [5], 'unlearn.types_config.FWF.datasets_config.WMDP_MCQ_CORPUS.lrs': [4e-07, 8e-07, 1.6e-06], 'unlearn.types_config.FWF.datasets_config.WMDP_MCQ_CORPUS.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.FWF.datasets_config.WMDP_MCQ_CORPUS.rcs.add': [0, 2, 4], 'unlearn.types_config.FWF.datasets_config.RANDOM_BD.epochs_lst': [5], 'unlearn.types_config.FWF.datasets_config.RANDOM_BD.lrs': [4e-07, 8e-07], 'unlearn.types_config.FWF.datasets_config.RANDOM_BD.rcs.range': [0.001, 0.01, 0.1, 1.0, 10.0, 100.0], 'unlearn.types_config.FWF.datasets_config.RANDOM_BD.rcs.add': [0, 2, 4], 'ft.num_splits': 2, 'ft.loss_types': ['QUESTION_LETTER_ANSWER'], 'ft.freeze_layers_coeffs': None, 'ft.freeze_layers': None, 'ft.epochs_lst': [6], 'ft.lrs': [1e-07, 2e-07, 4e-07, 8e-07, 1.6e-06, 3.2e-06], 'ft.save_models': False}, 'data_format': <DataFormat.CORPUS: 1>, 'loss_type': <LossType.CORPUS: 2>, 'batch_size': 4, 'disable_wandb': False, 'k_shot': 0, 'model': None, 'val_batch_size': 8}
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_init.py:init():667] starting backend
2024-10-06 19:27:11,276 INFO    MainThread:925998 [wandb_init.py:init():671] sending inform_init request
2024-10-06 19:27:11,277 INFO    MainThread:925998 [backend.py:_multiprocessing_setup():104] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-10-06 19:27:11,278 INFO    MainThread:925998 [wandb_init.py:init():684] backend started and connected
2024-10-06 19:27:11,282 INFO    MainThread:925998 [wandb_init.py:init():779] updated telemetry
2024-10-06 19:27:11,288 INFO    MainThread:925998 [wandb_init.py:init():812] communicating run to backend with 90.0 second timeout
2024-10-06 19:27:11,542 INFO    MainThread:925998 [wandb_init.py:init():863] starting run threads in backend
2024-10-06 19:27:11,607 INFO    MainThread:925998 [wandb_run.py:_console_start():2465] atexit reg
2024-10-06 19:27:11,607 INFO    MainThread:925998 [wandb_run.py:_redirect():2313] redirect: wrap_raw
2024-10-06 19:27:11,607 INFO    MainThread:925998 [wandb_run.py:_redirect():2378] Wrapping output streams.
2024-10-06 19:27:11,607 INFO    MainThread:925998 [wandb_run.py:_redirect():2403] Redirects installed.
2024-10-06 19:27:11,609 INFO    MainThread:925998 [wandb_init.py:init():907] run started, returning control to user process
2024-10-06 19:27:22,770 WARNING MsgRouterThr:925998 [router.py:message_loop():77] message_loop has been closed
